import { TARGET } from '../../constants/target';
import { isBrowser } from '../is-browser';
const getLocation = () => {
    if (TARGET === 'reactNative') {
        return null;
    }
    else if (isBrowser()) {
        const parsedLocation = new URL(location.href);
        // IE11 bug with parsed path being empty string
        // causes issues with our user targeting
        if (parsedLocation.pathname === '') {
            parsedLocation.pathname = '/';
        }
        return parsedLocation;
    }
    else {
        console.warn('Cannot get location for tracking in non-browser environment');
        return null;
    }
};
const getUserAgent = () => typeof navigator === 'object' && navigator.userAgent || '';
export const getUserAttributes = () => {
    const userAgent = getUserAgent();
    const isMobile = {
        Android() {
            return userAgent.match(/Android/i);
        },
        BlackBerry() {
            return userAgent.match(/BlackBerry/i);
        },
        iOS() {
            return userAgent.match(/iPhone|iPod/i);
        },
        Opera() {
            return userAgent.match(/Opera Mini/i);
        },
        Windows() {
            return userAgent.match(/IEMobile/i) || userAgent.match(/WPDesktop/i);
        },
        any() {
            return isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows() || TARGET === 'reactNative';
        }
    };
    const isTablet = userAgent.match(/Tablet|iPad/i);
    const url = getLocation();
    return {
        urlPath: url?.pathname,
        host: url?.host || url?.hostname,
        device: isTablet ? 'tablet' : isMobile.any() ? 'mobile' : 'desktop'
    };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9mdW5jdGlvbnMvdHJhY2svaGVscGVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFFaEQsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMxQyxNQUFNLFdBQVcsR0FBRyxHQUFrQixFQUFFO0lBQ3RDLElBQUksTUFBTSxLQUFLLGFBQWEsRUFBRTtRQUM1QixPQUFPLElBQUksQ0FBQztLQUNiO1NBQU0sSUFBSSxTQUFTLEVBQUUsRUFBRTtRQUN0QixNQUFNLGNBQWMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFOUMsK0NBQStDO1FBQy9DLHdDQUF3QztRQUN4QyxJQUFJLGNBQWMsQ0FBQyxRQUFRLEtBQUssRUFBRSxFQUFFO1lBQ2xDLGNBQWMsQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDO1NBQy9CO1FBQ0QsT0FBTyxjQUFjLENBQUM7S0FDdkI7U0FBTTtRQUNMLE9BQU8sQ0FBQyxJQUFJLENBQUMsNkRBQTZELENBQUMsQ0FBQztRQUM1RSxPQUFPLElBQUksQ0FBQztLQUNiO0FBQ0gsQ0FBQyxDQUFDO0FBQ0YsTUFBTSxZQUFZLEdBQUcsR0FBRyxFQUFFLENBQUMsT0FBTyxTQUFTLEtBQUssUUFBUSxJQUFJLFNBQVMsQ0FBQyxTQUFTLElBQUksRUFBRSxDQUFDO0FBQ3RGLE1BQU0sQ0FBQyxNQUFNLGlCQUFpQixHQUFHLEdBQUcsRUFBRTtJQUNwQyxNQUFNLFNBQVMsR0FBRyxZQUFZLEVBQUUsQ0FBQztJQUNqQyxNQUFNLFFBQVEsR0FBRztRQUNmLE9BQU87WUFDTCxPQUFPLFNBQVMsQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDckMsQ0FBQztRQUNELFVBQVU7WUFDUixPQUFPLFNBQVMsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDeEMsQ0FBQztRQUNELEdBQUc7WUFDRCxPQUFPLFNBQVMsQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDekMsQ0FBQztRQUNELEtBQUs7WUFDSCxPQUFPLFNBQVMsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDeEMsQ0FBQztRQUNELE9BQU87WUFDTCxPQUFPLFNBQVMsQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLElBQUksU0FBUyxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUN2RSxDQUFDO1FBQ0QsR0FBRztZQUNELE9BQU8sUUFBUSxDQUFDLE9BQU8sRUFBRSxJQUFJLFFBQVEsQ0FBQyxVQUFVLEVBQUUsSUFBSSxRQUFRLENBQUMsR0FBRyxFQUFFLElBQUksUUFBUSxDQUFDLEtBQUssRUFBRSxJQUFJLFFBQVEsQ0FBQyxPQUFPLEVBQUUsSUFBSSxNQUFNLEtBQUssYUFBYSxDQUFDO1FBQzdJLENBQUM7S0FDRixDQUFDO0lBQ0YsTUFBTSxRQUFRLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUNqRCxNQUFNLEdBQUcsR0FBRyxXQUFXLEVBQUUsQ0FBQztJQUMxQixPQUFPO1FBQ0wsT0FBTyxFQUFFLEdBQUcsRUFBRSxRQUFRO1FBQ3RCLElBQUksRUFBRSxHQUFHLEVBQUUsSUFBSSxJQUFJLEdBQUcsRUFBRSxRQUFRO1FBQ2hDLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFNBQVM7S0FDcEUsQ0FBQztBQUNKLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRBUkdFVCB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy90YXJnZXQnO1xuaW1wb3J0IHR5cGUgeyBOdWxsYWJsZSB9IGZyb20gJy4uLy4uL2hlbHBlcnMvbnVsbGFibGUnO1xuaW1wb3J0IHsgaXNCcm93c2VyIH0gZnJvbSAnLi4vaXMtYnJvd3Nlcic7XG5jb25zdCBnZXRMb2NhdGlvbiA9ICgpOiBOdWxsYWJsZTxVUkw+ID0+IHtcbiAgaWYgKFRBUkdFVCA9PT0gJ3JlYWN0TmF0aXZlJykge1xuICAgIHJldHVybiBudWxsO1xuICB9IGVsc2UgaWYgKGlzQnJvd3NlcigpKSB7XG4gICAgY29uc3QgcGFyc2VkTG9jYXRpb24gPSBuZXcgVVJMKGxvY2F0aW9uLmhyZWYpO1xuXG4gICAgLy8gSUUxMSBidWcgd2l0aCBwYXJzZWQgcGF0aCBiZWluZyBlbXB0eSBzdHJpbmdcbiAgICAvLyBjYXVzZXMgaXNzdWVzIHdpdGggb3VyIHVzZXIgdGFyZ2V0aW5nXG4gICAgaWYgKHBhcnNlZExvY2F0aW9uLnBhdGhuYW1lID09PSAnJykge1xuICAgICAgcGFyc2VkTG9jYXRpb24ucGF0aG5hbWUgPSAnLyc7XG4gICAgfVxuICAgIHJldHVybiBwYXJzZWRMb2NhdGlvbjtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLndhcm4oJ0Nhbm5vdCBnZXQgbG9jYXRpb24gZm9yIHRyYWNraW5nIGluIG5vbi1icm93c2VyIGVudmlyb25tZW50Jyk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn07XG5jb25zdCBnZXRVc2VyQWdlbnQgPSAoKSA9PiB0eXBlb2YgbmF2aWdhdG9yID09PSAnb2JqZWN0JyAmJiBuYXZpZ2F0b3IudXNlckFnZW50IHx8ICcnO1xuZXhwb3J0IGNvbnN0IGdldFVzZXJBdHRyaWJ1dGVzID0gKCkgPT4ge1xuICBjb25zdCB1c2VyQWdlbnQgPSBnZXRVc2VyQWdlbnQoKTtcbiAgY29uc3QgaXNNb2JpbGUgPSB7XG4gICAgQW5kcm9pZCgpIHtcbiAgICAgIHJldHVybiB1c2VyQWdlbnQubWF0Y2goL0FuZHJvaWQvaSk7XG4gICAgfSxcbiAgICBCbGFja0JlcnJ5KCkge1xuICAgICAgcmV0dXJuIHVzZXJBZ2VudC5tYXRjaCgvQmxhY2tCZXJyeS9pKTtcbiAgICB9LFxuICAgIGlPUygpIHtcbiAgICAgIHJldHVybiB1c2VyQWdlbnQubWF0Y2goL2lQaG9uZXxpUG9kL2kpO1xuICAgIH0sXG4gICAgT3BlcmEoKSB7XG4gICAgICByZXR1cm4gdXNlckFnZW50Lm1hdGNoKC9PcGVyYSBNaW5pL2kpO1xuICAgIH0sXG4gICAgV2luZG93cygpIHtcbiAgICAgIHJldHVybiB1c2VyQWdlbnQubWF0Y2goL0lFTW9iaWxlL2kpIHx8IHVzZXJBZ2VudC5tYXRjaCgvV1BEZXNrdG9wL2kpO1xuICAgIH0sXG4gICAgYW55KCkge1xuICAgICAgcmV0dXJuIGlzTW9iaWxlLkFuZHJvaWQoKSB8fCBpc01vYmlsZS5CbGFja0JlcnJ5KCkgfHwgaXNNb2JpbGUuaU9TKCkgfHwgaXNNb2JpbGUuT3BlcmEoKSB8fCBpc01vYmlsZS5XaW5kb3dzKCkgfHwgVEFSR0VUID09PSAncmVhY3ROYXRpdmUnO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgaXNUYWJsZXQgPSB1c2VyQWdlbnQubWF0Y2goL1RhYmxldHxpUGFkL2kpO1xuICBjb25zdCB1cmwgPSBnZXRMb2NhdGlvbigpO1xuICByZXR1cm4ge1xuICAgIHVybFBhdGg6IHVybD8ucGF0aG5hbWUsXG4gICAgaG9zdDogdXJsPy5ob3N0IHx8IHVybD8uaG9zdG5hbWUsXG4gICAgZGV2aWNlOiBpc1RhYmxldCA/ICd0YWJsZXQnIDogaXNNb2JpbGUuYW55KCkgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJ1xuICB9O1xufSJdfQ==