const DEFAULT_TRUSTED_HOSTS = ['*.beta.builder.io', 'beta.builder.io', 'builder.io', 'localhost', 'qa.builder.io'];
export function isFromTrustedHost(trustedHosts, e) {
    if (!e.origin.startsWith('http') && !e.origin.startsWith('https')) {
        return false;
    }
    const url = new URL(e.origin), hostname = url.hostname;
    return (trustedHosts || DEFAULT_TRUSTED_HOSTS).findIndex(trustedHost => trustedHost.startsWith('*.') ? hostname.endsWith(trustedHost.slice(1)) : trustedHost === hostname) > -1;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaXMtZnJvbS10cnVzdGVkLWhvc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvZnVuY3Rpb25zL2lzLWZyb20tdHJ1c3RlZC1ob3N0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE1BQU0scUJBQXFCLEdBQUcsQ0FBQyxtQkFBbUIsRUFBRSxpQkFBaUIsRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFFLGVBQWUsQ0FBQyxDQUFDO0FBQ25ILE1BQU0sVUFBVSxpQkFBaUIsQ0FBQyxZQUFrQyxFQUFFLENBRXJFO0lBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUU7UUFDakUsT0FBTyxLQUFLLENBQUM7S0FDZDtJQUNELE1BQU0sR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsRUFDM0IsUUFBUSxHQUFHLEdBQUcsQ0FBQyxRQUFRLENBQUM7SUFDMUIsT0FBTyxDQUFDLFlBQVksSUFBSSxxQkFBcUIsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLEtBQUssUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDbEwsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IERFRkFVTFRfVFJVU1RFRF9IT1NUUyA9IFsnKi5iZXRhLmJ1aWxkZXIuaW8nLCAnYmV0YS5idWlsZGVyLmlvJywgJ2J1aWxkZXIuaW8nLCAnbG9jYWxob3N0JywgJ3FhLmJ1aWxkZXIuaW8nXTtcbmV4cG9ydCBmdW5jdGlvbiBpc0Zyb21UcnVzdGVkSG9zdCh0cnVzdGVkSG9zdHM6IHN0cmluZ1tdIHwgdW5kZWZpbmVkLCBlOiB7XG4gIG9yaWdpbjogc3RyaW5nO1xufSk6IGJvb2xlYW4ge1xuICBpZiAoIWUub3JpZ2luLnN0YXJ0c1dpdGgoJ2h0dHAnKSAmJiAhZS5vcmlnaW4uc3RhcnRzV2l0aCgnaHR0cHMnKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBjb25zdCB1cmwgPSBuZXcgVVJMKGUub3JpZ2luKSxcbiAgICBob3N0bmFtZSA9IHVybC5ob3N0bmFtZTtcbiAgcmV0dXJuICh0cnVzdGVkSG9zdHMgfHwgREVGQVVMVF9UUlVTVEVEX0hPU1RTKS5maW5kSW5kZXgodHJ1c3RlZEhvc3QgPT4gdHJ1c3RlZEhvc3Quc3RhcnRzV2l0aCgnKi4nKSA/IGhvc3RuYW1lLmVuZHNXaXRoKHRydXN0ZWRIb3N0LnNsaWNlKDEpKSA6IHRydXN0ZWRIb3N0ID09PSBob3N0bmFtZSkgPiAtMTtcbn0iXX0=