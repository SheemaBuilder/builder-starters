import { getCookie, setCookie } from './cookie';
import { checkIsDefined } from './nullable';
import { uuid } from './uuid';
const SESSION_LOCAL_STORAGE_KEY = 'builderSessionId';
export const getSessionId = async ({ canTrack }) => {
    if (!canTrack) {
        return undefined;
    }
    const sessionId = await getCookie({
        name: SESSION_LOCAL_STORAGE_KEY,
        canTrack
    });
    if (checkIsDefined(sessionId)) {
        return sessionId;
    }
    else {
        const newSessionId = createSessionId();
        setSessionId({
            id: newSessionId,
            canTrack
        });
        return newSessionId;
    }
};
export const createSessionId = () => uuid();
export const setSessionId = ({ id, canTrack }) => setCookie({
    name: SESSION_LOCAL_STORAGE_KEY,
    value: id,
    canTrack
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Vzc2lvbklkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2hlbHBlcnMvc2Vzc2lvbklkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQ2hELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFDNUMsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUM5QixNQUFNLHlCQUF5QixHQUFHLGtCQUFrQixDQUFDO0FBQ3JELE1BQU0sQ0FBQyxNQUFNLFlBQVksR0FBRyxLQUFLLEVBQUUsRUFDakMsUUFBUSxFQUNDLEVBQStCLEVBQUU7SUFDMUMsSUFBSSxDQUFDLFFBQVEsRUFBRTtRQUNiLE9BQU8sU0FBUyxDQUFDO0tBQ2xCO0lBQ0QsTUFBTSxTQUFTLEdBQUcsTUFBTSxTQUFTLENBQUM7UUFDaEMsSUFBSSxFQUFFLHlCQUF5QjtRQUMvQixRQUFRO0tBQ1QsQ0FBQyxDQUFDO0lBQ0gsSUFBSSxjQUFjLENBQUMsU0FBUyxDQUFDLEVBQUU7UUFDN0IsT0FBTyxTQUFTLENBQUM7S0FDbEI7U0FBTTtRQUNMLE1BQU0sWUFBWSxHQUFHLGVBQWUsRUFBRSxDQUFDO1FBQ3ZDLFlBQVksQ0FBQztZQUNYLEVBQUUsRUFBRSxZQUFZO1lBQ2hCLFFBQVE7U0FDVCxDQUFDLENBQUM7UUFDSCxPQUFPLFlBQVksQ0FBQztLQUNyQjtBQUNILENBQUMsQ0FBQztBQUNGLE1BQU0sQ0FBQyxNQUFNLGVBQWUsR0FBRyxHQUFHLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUM1QyxNQUFNLENBQUMsTUFBTSxZQUFZLEdBQUcsQ0FBQyxFQUMzQixFQUFFLEVBQ0YsUUFBUSxFQUdFLEVBQUUsRUFBRSxDQUFDLFNBQVMsQ0FBQztJQUN6QixJQUFJLEVBQUUseUJBQXlCO0lBQy9CLEtBQUssRUFBRSxFQUFFO0lBQ1QsUUFBUTtDQUNULENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQ2FuVHJhY2sgfSBmcm9tICcuLi90eXBlcy9jYW4tdHJhY2snO1xuaW1wb3J0IHsgZ2V0Q29va2llLCBzZXRDb29raWUgfSBmcm9tICcuL2Nvb2tpZSc7XG5pbXBvcnQgeyBjaGVja0lzRGVmaW5lZCB9IGZyb20gJy4vbnVsbGFibGUnO1xuaW1wb3J0IHsgdXVpZCB9IGZyb20gJy4vdXVpZCc7XG5jb25zdCBTRVNTSU9OX0xPQ0FMX1NUT1JBR0VfS0VZID0gJ2J1aWxkZXJTZXNzaW9uSWQnO1xuZXhwb3J0IGNvbnN0IGdldFNlc3Npb25JZCA9IGFzeW5jICh7XG4gIGNhblRyYWNrXG59OiBDYW5UcmFjayk6IFByb21pc2U8c3RyaW5nIHwgdW5kZWZpbmVkPiA9PiB7XG4gIGlmICghY2FuVHJhY2spIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIGNvbnN0IHNlc3Npb25JZCA9IGF3YWl0IGdldENvb2tpZSh7XG4gICAgbmFtZTogU0VTU0lPTl9MT0NBTF9TVE9SQUdFX0tFWSxcbiAgICBjYW5UcmFja1xuICB9KTtcbiAgaWYgKGNoZWNrSXNEZWZpbmVkKHNlc3Npb25JZCkpIHtcbiAgICByZXR1cm4gc2Vzc2lvbklkO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IG5ld1Nlc3Npb25JZCA9IGNyZWF0ZVNlc3Npb25JZCgpO1xuICAgIHNldFNlc3Npb25JZCh7XG4gICAgICBpZDogbmV3U2Vzc2lvbklkLFxuICAgICAgY2FuVHJhY2tcbiAgICB9KTtcbiAgICByZXR1cm4gbmV3U2Vzc2lvbklkO1xuICB9XG59O1xuZXhwb3J0IGNvbnN0IGNyZWF0ZVNlc3Npb25JZCA9ICgpID0+IHV1aWQoKTtcbmV4cG9ydCBjb25zdCBzZXRTZXNzaW9uSWQgPSAoe1xuICBpZCxcbiAgY2FuVHJhY2tcbn06IHtcbiAgaWQ6IHN0cmluZztcbn0gJiBDYW5UcmFjaykgPT4gc2V0Q29va2llKHtcbiAgbmFtZTogU0VTU0lPTl9MT0NBTF9TVE9SQUdFX0tFWSxcbiAgdmFsdWU6IGlkLFxuICBjYW5UcmFja1xufSkiXX0=