import { Component, ViewChild, Input, forwardRef } from "@angular/core";
import { CommonModule } from "@angular/common";
import Block from "../../block";
import InteractiveElement from "../interactive-element";
import { getWrapperProps } from "./component-ref.helpers";
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
export default class ComponentRef {
    trackByChild0(_, child) {
        return child.id;
    }
    constructor(vcRef) {
        this.vcRef = vcRef;
        this.Wrapper = null;
        this.node_0_state_Wrapper = null;
        this.mergedInputs_v6przu = {};
    }
    ngOnInit() {
        this.Wrapper = this.isInteractive ? InteractiveElement : this.componentRef;
        this.node_0_state_Wrapper = {
            ...getWrapperProps({
                componentOptions: this.componentOptions,
                builderBlock: this.builderBlock,
                context: this.context,
                componentRef: this.componentRef,
                linkComponent: this.linkComponent,
                includeBlockProps: this.includeBlockProps,
                isInteractive: this.isInteractive,
                contextValue: this.context,
            }),
        };
        this.mergedInputs_v6przu = { ...this.node_0_state_Wrapper };
        const wrapperTemplate = this.vcRef.createEmbeddedView(this.wrapperTemplateRef);
        wrapperTemplate.detectChanges();
        this.myContent = [wrapperTemplate.rootNodes];
    }
    ngOnChanges(changes) {
        if (changes.componentOptions) {
            let foundChange = false;
            for (const key in changes.componentOptions.previousValue) {
                if (changes.componentOptions.previousValue[key] !== changes.componentOptions.currentValue[key]) {
                    foundChange = true;
                    break;
                }
            }
            if (!foundChange) {
                return;
            }
        }
        if (typeof window !== "undefined") {
            this.node_0_state_Wrapper = {
                ...getWrapperProps({
                    componentOptions: this.componentOptions,
                    builderBlock: this.builderBlock,
                    context: this.context,
                    componentRef: this.componentRef,
                    linkComponent: this.linkComponent,
                    includeBlockProps: this.includeBlockProps,
                    isInteractive: this.isInteractive,
                    contextValue: this.context,
                }),
            };
            this.mergedInputs_v6przu = { ...this.node_0_state_Wrapper };
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: ComponentRef, deps: [{ token: i0.ViewContainerRef }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.2.12", type: ComponentRef, isStandalone: true, selector: "component-ref", inputs: { componentOptions: "componentOptions", builderBlock: "builderBlock", context: "context", componentRef: "componentRef", linkComponent: "linkComponent", includeBlockProps: "includeBlockProps", isInteractive: "isInteractive", blockChildren: "blockChildren", registeredComponents: "registeredComponents" }, viewQueries: [{ propertyName: "wrapperTemplateRef", first: true, predicate: ["wrapperTemplate"], descendants: true, static: true }], usesOnChanges: true, ngImport: i0, template: `
    <ng-template #wrapperTemplate>
      <ng-container *ngIf="componentRef">
<ng-container *ngFor="let child of blockChildren; trackBy: trackByChild0">
        <block
          [block]="child"
          [context]="context"
          [registeredComponents]="registeredComponents"
          [linkComponent]="linkComponent"
        ></block>
      </ng-container>
</ng-container>
    </ng-template>
    <ng-container *ngIf="componentRef">
      <ng-container
        *ngComponentOutlet="
              Wrapper;
              inputs: mergedInputs_v6przu;
              content: myContent;
              "
      ></ng-container>
    </ng-container>
  `, isInline: true, styles: [":host{display:contents}\n"], dependencies: [{ kind: "ngmodule", type: i0.forwardRef(function () { return CommonModule; }) }, { kind: "directive", type: i0.forwardRef(function () { return i1.NgComponentOutlet; }), selector: "[ngComponentOutlet]", inputs: ["ngComponentOutlet", "ngComponentOutletInputs", "ngComponentOutletInjector", "ngComponentOutletContent", "ngComponentOutletNgModule", "ngComponentOutletNgModuleFactory"] }, { kind: "directive", type: i0.forwardRef(function () { return i1.NgForOf; }), selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i0.forwardRef(function () { return i1.NgIf; }), selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: i0.forwardRef(function () { return Block; }), selector: "block", inputs: ["block", "context", "registeredComponents", "linkComponent"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: ComponentRef, decorators: [{
            type: Component,
            args: [{ selector: "component-ref", template: `
    <ng-template #wrapperTemplate>
      <ng-container *ngIf="componentRef">
<ng-container *ngFor="let child of blockChildren; trackBy: trackByChild0">
        <block
          [block]="child"
          [context]="context"
          [registeredComponents]="registeredComponents"
          [linkComponent]="linkComponent"
        ></block>
      </ng-container>
</ng-container>
    </ng-template>
    <ng-container *ngIf="componentRef">
      <ng-container
        *ngComponentOutlet="
              Wrapper;
              inputs: mergedInputs_v6przu;
              content: myContent;
              "
      ></ng-container>
    </ng-container>
  `, standalone: true, imports: [CommonModule, forwardRef(() => Block)], styles: [":host{display:contents}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ViewContainerRef }]; }, propDecorators: { componentOptions: [{
                type: Input
            }], builderBlock: [{
                type: Input
            }], context: [{
                type: Input
            }], componentRef: [{
                type: Input
            }], linkComponent: [{
                type: Input
            }], includeBlockProps: [{
                type: Input
            }], isInteractive: [{
                type: Input
            }], blockChildren: [{
                type: Input
            }], registeredComponents: [{
                type: Input
            }], wrapperTemplateRef: [{
                type: ViewChild,
                args: ["wrapperTemplate", { static: true }]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LXJlZi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL2Jsb2NrL2NvbXBvbmVudHMvY29tcG9uZW50LXJlZi9jb21wb25lbnQtcmVmLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsU0FBUyxFQUVULEtBQUssRUFJUCxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDbEMsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRy9DLE9BQU8sS0FBSyxNQUFNLGFBQWEsQ0FBQztBQUNoQyxPQUFPLGtCQUFrQixNQUFNLHdCQUF3QixDQUFDO0FBRXhELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQzs7O0FBcUMxRCxNQUFNLENBQUMsT0FBTyxPQUFPLFlBQVk7SUFtQi9CLGFBQWEsQ0FBQyxDQUFDLEVBQUUsS0FBSztRQUNwQixPQUFPLEtBQUssQ0FBQyxFQUFFLENBQUM7SUFDbEIsQ0FBQztJQUVELFlBQW9CLEtBQXVCO1FBQXZCLFVBQUssR0FBTCxLQUFLLENBQWtCO1FBUDNDLFlBQU8sR0FBRyxJQUFJLENBQUM7UUFDZix5QkFBb0IsR0FBRyxJQUFJLENBQUM7UUFDNUIsd0JBQW1CLEdBQUcsRUFBUyxDQUFDO0lBS2MsQ0FBQztJQUUvQyxRQUFRO1FBQ04sSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQztRQUMzRSxJQUFJLENBQUMsb0JBQW9CLEdBQUc7WUFDMUIsR0FBRyxlQUFlLENBQUM7Z0JBQ2pCLGdCQUFnQixFQUFFLElBQUksQ0FBQyxnQkFBZ0I7Z0JBQ3ZDLFlBQVksRUFBRSxJQUFJLENBQUMsWUFBWTtnQkFDL0IsT0FBTyxFQUFFLElBQUksQ0FBQyxPQUFPO2dCQUNyQixZQUFZLEVBQUUsSUFBSSxDQUFDLFlBQVk7Z0JBQy9CLGFBQWEsRUFBRSxJQUFJLENBQUMsYUFBYTtnQkFDakMsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLGlCQUFpQjtnQkFDekMsYUFBYSxFQUFFLElBQUksQ0FBQyxhQUFhO2dCQUNqQyxZQUFZLEVBQUUsSUFBSSxDQUFDLE9BQU87YUFDM0IsQ0FBQztTQUNILENBQUM7UUFDRixJQUFJLENBQUMsbUJBQW1CLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1FBRTVELE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUM7UUFDekUsZUFBZSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxTQUFTLEdBQUcsQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDckQsQ0FBQztJQUVELFdBQVcsQ0FBQyxPQUFzQjtRQUNwQixJQUFJLE9BQU8sQ0FBQyxnQkFBZ0IsRUFBRTtZQUM1QixJQUFJLFdBQVcsR0FBRyxLQUFLLENBQUM7WUFDeEIsS0FBSyxNQUFNLEdBQUcsSUFBSSxPQUFPLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxFQUFFO2dCQUN4RCxJQUFJLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLEtBQUssT0FBTyxDQUFDLGdCQUFnQixDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsRUFBRTtvQkFDOUYsV0FBVyxHQUFHLElBQUksQ0FBQztvQkFDbkIsTUFBTTtpQkFDUDthQUNGO1lBQ0QsSUFBSSxDQUFDLFdBQVcsRUFBRTtnQkFDaEIsT0FBTzthQUNSO1NBQ0Y7UUFDYixJQUFJLE9BQU8sTUFBTSxLQUFLLFdBQVcsRUFBRTtZQUNqQyxJQUFJLENBQUMsb0JBQW9CLEdBQUc7Z0JBQzFCLEdBQUcsZUFBZSxDQUFDO29CQUNqQixnQkFBZ0IsRUFBRSxJQUFJLENBQUMsZ0JBQWdCO29CQUN2QyxZQUFZLEVBQUUsSUFBSSxDQUFDLFlBQVk7b0JBQy9CLE9BQU8sRUFBRSxJQUFJLENBQUMsT0FBTztvQkFDckIsWUFBWSxFQUFFLElBQUksQ0FBQyxZQUFZO29CQUMvQixhQUFhLEVBQUUsSUFBSSxDQUFDLGFBQWE7b0JBQ2pDLGlCQUFpQixFQUFFLElBQUksQ0FBQyxpQkFBaUI7b0JBQ3pDLGFBQWEsRUFBRSxJQUFJLENBQUMsYUFBYTtvQkFDakMsWUFBWSxFQUFFLElBQUksQ0FBQyxPQUFPO2lCQUMzQixDQUFDO2FBQ0gsQ0FBQztZQUNGLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7U0FDN0Q7SUFDSCxDQUFDOytHQTFFa0IsWUFBWTttR0FBWixZQUFZLDJoQkFqQ3JCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBc0JULHFJQVNTLFlBQVksb3FCQUFtQixLQUFLOzs0RkFFM0IsWUFBWTtrQkFuQ2hDLFNBQVM7K0JBQ0UsZUFBZSxZQUNmOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBc0JULGNBUVcsSUFBSSxXQUNQLENBQUMsWUFBWSxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQzt1R0FHdkMsZ0JBQWdCO3NCQUF4QixLQUFLO2dCQUNHLFlBQVk7c0JBQXBCLEtBQUs7Z0JBQ0csT0FBTztzQkFBZixLQUFLO2dCQUNHLFlBQVk7c0JBQXBCLEtBQUs7Z0JBQ0csYUFBYTtzQkFBckIsS0FBSztnQkFDRyxpQkFBaUI7c0JBQXpCLEtBQUs7Z0JBQ0csYUFBYTtzQkFBckIsS0FBSztnQkFDRyxhQUFhO3NCQUFyQixLQUFLO2dCQUNHLG9CQUFvQjtzQkFBNUIsS0FBSztnQkFHTixrQkFBa0I7c0JBRGpCLFNBQVM7dUJBQUMsaUJBQWlCLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBWaWV3Q2hpbGQsXG4gIEVsZW1lbnRSZWYsXG4gIElucHV0LFxuICBWaWV3Q29udGFpbmVyUmVmLFxuICBUZW1wbGF0ZVJlZixcbiAgU2ltcGxlQ2hhbmdlcyxcbmZvcndhcmRSZWYgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSBcIkBhbmd1bGFyL2NvbW1vblwiO1xuXG5pbXBvcnQgeyB3cmFwQ29tcG9uZW50UmVmIH0gZnJvbSBcIi4uLy4uLy4uL2NvbnRlbnQvd3JhcC1jb21wb25lbnQtcmVmXCI7XG5pbXBvcnQgQmxvY2sgZnJvbSBcIi4uLy4uL2Jsb2NrXCI7XG5pbXBvcnQgSW50ZXJhY3RpdmVFbGVtZW50IGZyb20gXCIuLi9pbnRlcmFjdGl2ZS1lbGVtZW50XCI7XG5pbXBvcnQgdHlwZSB7IENvbXBvbmVudFByb3BzIH0gZnJvbSBcIi4vY29tcG9uZW50LXJlZi5oZWxwZXJzXCI7XG5pbXBvcnQgeyBnZXRXcmFwcGVyUHJvcHMgfSBmcm9tIFwiLi9jb21wb25lbnQtcmVmLmhlbHBlcnNcIjtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiBcImNvbXBvbmVudC1yZWZcIixcbiAgdGVtcGxhdGU6IGBcbiAgICA8bmctdGVtcGxhdGUgI3dyYXBwZXJUZW1wbGF0ZT5cbiAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJjb21wb25lbnRSZWZcIj5cbjxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IGNoaWxkIG9mIGJsb2NrQ2hpbGRyZW47IHRyYWNrQnk6IHRyYWNrQnlDaGlsZDBcIj5cbiAgICAgICAgPGJsb2NrXG4gICAgICAgICAgW2Jsb2NrXT1cImNoaWxkXCJcbiAgICAgICAgICBbY29udGV4dF09XCJjb250ZXh0XCJcbiAgICAgICAgICBbcmVnaXN0ZXJlZENvbXBvbmVudHNdPVwicmVnaXN0ZXJlZENvbXBvbmVudHNcIlxuICAgICAgICAgIFtsaW5rQ29tcG9uZW50XT1cImxpbmtDb21wb25lbnRcIlxuICAgICAgICA+PC9ibG9jaz5cbiAgICAgIDwvbmctY29udGFpbmVyPlxuPC9uZy1jb250YWluZXI+XG4gICAgPC9uZy10ZW1wbGF0ZT5cbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiY29tcG9uZW50UmVmXCI+XG4gICAgICA8bmctY29udGFpbmVyXG4gICAgICAgICpuZ0NvbXBvbmVudE91dGxldD1cIlxuICAgICAgICAgICAgICBXcmFwcGVyO1xuICAgICAgICAgICAgICBpbnB1dHM6IG1lcmdlZElucHV0c192NnByenU7XG4gICAgICAgICAgICAgIGNvbnRlbnQ6IG15Q29udGVudDtcbiAgICAgICAgICAgICAgXCJcbiAgICAgID48L25nLWNvbnRhaW5lcj5cbiAgICA8L25nLWNvbnRhaW5lcj5cbiAgYCxcbiAgc3R5bGVzOiBbXG4gICAgYFxuICAgICAgOmhvc3Qge1xuICAgICAgICBkaXNwbGF5OiBjb250ZW50cztcbiAgICAgIH1cbiAgICBgLFxuICBdLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlLCBmb3J3YXJkUmVmKCgpID0+IEJsb2NrKV0sXG59KVxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29tcG9uZW50UmVmIHtcbiAgQElucHV0KCkgY29tcG9uZW50T3B0aW9ucyE6IENvbXBvbmVudFByb3BzW1wiY29tcG9uZW50T3B0aW9uc1wiXTtcbiAgQElucHV0KCkgYnVpbGRlckJsb2NrITogQ29tcG9uZW50UHJvcHNbXCJidWlsZGVyQmxvY2tcIl07XG4gIEBJbnB1dCgpIGNvbnRleHQhOiBDb21wb25lbnRQcm9wc1tcImNvbnRleHRcIl07XG4gIEBJbnB1dCgpIGNvbXBvbmVudFJlZiE6IENvbXBvbmVudFByb3BzW1wiY29tcG9uZW50UmVmXCJdO1xuICBASW5wdXQoKSBsaW5rQ29tcG9uZW50ITogQ29tcG9uZW50UHJvcHNbXCJsaW5rQ29tcG9uZW50XCJdO1xuICBASW5wdXQoKSBpbmNsdWRlQmxvY2tQcm9wcyE6IENvbXBvbmVudFByb3BzW1wiaW5jbHVkZUJsb2NrUHJvcHNcIl07XG4gIEBJbnB1dCgpIGlzSW50ZXJhY3RpdmUhOiBDb21wb25lbnRQcm9wc1tcImlzSW50ZXJhY3RpdmVcIl07XG4gIEBJbnB1dCgpIGJsb2NrQ2hpbGRyZW4hOiBDb21wb25lbnRQcm9wc1tcImJsb2NrQ2hpbGRyZW5cIl07XG4gIEBJbnB1dCgpIHJlZ2lzdGVyZWRDb21wb25lbnRzITogQ29tcG9uZW50UHJvcHNbXCJyZWdpc3RlcmVkQ29tcG9uZW50c1wiXTtcblxuICBAVmlld0NoaWxkKFwid3JhcHBlclRlbXBsYXRlXCIsIHsgc3RhdGljOiB0cnVlIH0pXG4gIHdyYXBwZXJUZW1wbGF0ZVJlZiE6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgbXlDb250ZW50PzogYW55W11bXTtcblxuICBXcmFwcGVyID0gbnVsbDtcbiAgbm9kZV8wX3N0YXRlX1dyYXBwZXIgPSBudWxsO1xuICBtZXJnZWRJbnB1dHNfdjZwcnp1ID0ge30gYXMgYW55O1xuICB0cmFja0J5Q2hpbGQwKF8sIGNoaWxkKSB7XG4gICAgcmV0dXJuIGNoaWxkLmlkO1xuICB9XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSB2Y1JlZjogVmlld0NvbnRhaW5lclJlZikge31cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLldyYXBwZXIgPSB0aGlzLmlzSW50ZXJhY3RpdmUgPyBJbnRlcmFjdGl2ZUVsZW1lbnQgOiB0aGlzLmNvbXBvbmVudFJlZjtcbiAgICB0aGlzLm5vZGVfMF9zdGF0ZV9XcmFwcGVyID0ge1xuICAgICAgLi4uZ2V0V3JhcHBlclByb3BzKHtcbiAgICAgICAgY29tcG9uZW50T3B0aW9uczogdGhpcy5jb21wb25lbnRPcHRpb25zLFxuICAgICAgICBidWlsZGVyQmxvY2s6IHRoaXMuYnVpbGRlckJsb2NrLFxuICAgICAgICBjb250ZXh0OiB0aGlzLmNvbnRleHQsXG4gICAgICAgIGNvbXBvbmVudFJlZjogdGhpcy5jb21wb25lbnRSZWYsXG4gICAgICAgIGxpbmtDb21wb25lbnQ6IHRoaXMubGlua0NvbXBvbmVudCxcbiAgICAgICAgaW5jbHVkZUJsb2NrUHJvcHM6IHRoaXMuaW5jbHVkZUJsb2NrUHJvcHMsXG4gICAgICAgIGlzSW50ZXJhY3RpdmU6IHRoaXMuaXNJbnRlcmFjdGl2ZSxcbiAgICAgICAgY29udGV4dFZhbHVlOiB0aGlzLmNvbnRleHQsXG4gICAgICB9KSxcbiAgICB9O1xuICAgIHRoaXMubWVyZ2VkSW5wdXRzX3Y2cHJ6dSA9IHsgLi4udGhpcy5ub2RlXzBfc3RhdGVfV3JhcHBlciB9O1xuXG4gICAgY29uc3Qgd3JhcHBlclRlbXBsYXRlID0gdGhpcy52Y1JlZi5jcmVhdGVFbWJlZGRlZFZpZXcodGhpcy53cmFwcGVyVGVtcGxhdGVSZWYpO1xuICAgICAgICAgIHdyYXBwZXJUZW1wbGF0ZS5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICAgICAgdGhpcy5teUNvbnRlbnQgPSBbd3JhcHBlclRlbXBsYXRlLnJvb3ROb2Rlc107XG4gIH1cblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNoYW5nZXMuY29tcG9uZW50T3B0aW9ucykge1xuICAgICAgICAgICAgICAgICAgbGV0IGZvdW5kQ2hhbmdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBjaGFuZ2VzLmNvbXBvbmVudE9wdGlvbnMucHJldmlvdXNWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdlcy5jb21wb25lbnRPcHRpb25zLnByZXZpb3VzVmFsdWVba2V5XSAhPT0gY2hhbmdlcy5jb21wb25lbnRPcHRpb25zLmN1cnJlbnRWYWx1ZVtrZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgZm91bmRDaGFuZ2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBpZiAoIWZvdW5kQ2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHRoaXMubm9kZV8wX3N0YXRlX1dyYXBwZXIgPSB7XG4gICAgICAgIC4uLmdldFdyYXBwZXJQcm9wcyh7XG4gICAgICAgICAgY29tcG9uZW50T3B0aW9uczogdGhpcy5jb21wb25lbnRPcHRpb25zLFxuICAgICAgICAgIGJ1aWxkZXJCbG9jazogdGhpcy5idWlsZGVyQmxvY2ssXG4gICAgICAgICAgY29udGV4dDogdGhpcy5jb250ZXh0LFxuICAgICAgICAgIGNvbXBvbmVudFJlZjogdGhpcy5jb21wb25lbnRSZWYsXG4gICAgICAgICAgbGlua0NvbXBvbmVudDogdGhpcy5saW5rQ29tcG9uZW50LFxuICAgICAgICAgIGluY2x1ZGVCbG9ja1Byb3BzOiB0aGlzLmluY2x1ZGVCbG9ja1Byb3BzLFxuICAgICAgICAgIGlzSW50ZXJhY3RpdmU6IHRoaXMuaXNJbnRlcmFjdGl2ZSxcbiAgICAgICAgICBjb250ZXh0VmFsdWU6IHRoaXMuY29udGV4dCxcbiAgICAgICAgfSksXG4gICAgICB9O1xuICAgICAgdGhpcy5tZXJnZWRJbnB1dHNfdjZwcnp1ID0geyAuLi50aGlzLm5vZGVfMF9zdGF0ZV9XcmFwcGVyIH07XG4gICAgfVxuICB9XG59XG4iXX0=